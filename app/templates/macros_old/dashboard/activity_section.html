{% from "macros/base/icons.html" import icon %}
{% from "macros/ui/badges.html" import priority_badge %}

{# Simple card item macros for dashboard #}
{% macro task_card_item(task, color='gray', with_priority_badge=false) %}
<div class="p-3 bg-{{ color }}-50 rounded-md border border-{{ color }}-200">
    <div class="flex items-start justify-between">
        <div class="flex-1">
            <h4 class="font-medium text-gray-900">{{ task.title }}</h4>
            {% if task.description %}
            <p class="text-sm text-gray-600 mt-1">{{ task.description|truncate(100) }}</p>
            {% endif %}
            <p class="text-xs text-{{ color }}-600 mt-2">Due: {{ task.due_date|default('No date', true) }}</p>
        </div>
        {% if with_priority_badge and task.priority %}
        {{ priority_badge(task.priority) }}
        {% endif %}
    </div>
</div>
{% endmacro %}

{% macro note_card_item(note) %}
<div class="p-3 bg-gray-50 rounded-md border border-gray-200">
    <p class="text-sm text-gray-700">{{ note.content|truncate(150) }}</p>
    <p class="text-xs text-gray-500 mt-2">{{ note.created_at|default('Recently', true) }}</p>
</div>
{% endmacro %}

{% macro entity_card_item(entity, entity_type) %}
<div class="p-3 bg-white rounded-md border border-gray-200 hover:border-blue-300 transition-colors">
    <h4 class="font-medium text-gray-900">{{ entity.name|default(entity.title, true) }}</h4>
    {% if entity.value %}
    <p class="text-sm text-green-600 mt-1">${{ "{:,.2f}".format(entity.value) }}</p>
    {% endif %}
    <p class="text-xs text-gray-500 mt-2">{{ entity_type|capitalize }}</p>
</div>
{% endmacro %}

{% macro dashboard_overdue_section(overdue_tasks) %}
{# Professional Overdue Tasks Section #}
{% if overdue_tasks %}
<div class="p-6 bg-white rounded-lg border border-gray-200 shadow-sm">
    <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-900 flex items-center">
            {{ icon('exclamation-triangle', 'md', 'text-red-500 mr-2') }}
            Overdue Tasks
        </h3>
        <a href="/tasks/" class="text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors">
            View All →
        </a>
    </div>

    <div class="space-y-3">
        {% for task in overdue_tasks %}
        {{ task_card_item(task, 'red', with_priority_badge=true) }}
        {% endfor %}
    </div>
</div>
{% endif %}
{% endmacro %}

{% macro dashboard_notes_section(recent_notes) %}
{# Professional Recent Notes Section #}
<div class="p-6 bg-white rounded-lg border border-gray-200 shadow-sm">
    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
        {{ icon('document', 'md', 'text-gray-500 mr-2') }}
        Recent Notes
    </h3>

    <div class="space-y-3">
        {% for note in recent_notes %}
        {{ note_card_item(note) }}
        {% endfor %}
    </div>
</div>
{% endmacro %}

{% macro dashboard_tasks_section(recent_tasks) %}
{# Professional Recent Tasks Section #}
<div class="p-6 bg-white rounded-lg border border-gray-200 shadow-sm">
    <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-900 flex items-center">
            {{ icon('clipboard-list', 'md', 'text-gray-500 mr-2') }}
            Recent Tasks
        </h3>
        <a href="/tasks/" class="text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors">
            View All →
        </a>
    </div>

    <div class="space-y-3">
        {% for task in recent_tasks %}
        {{ task_card_item(task, 'gray', with_priority_badge=true) }}
        {% endfor %}
    </div>
</div>
{% endmacro %}

{% macro dashboard_opportunities_section(recent_opportunities) %}
{# Professional Recent Opportunities Section #}
<div class="p-6 bg-white rounded-lg border border-gray-200 shadow-sm">
    <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-900 flex items-center">
            {{ icon('currency-dollar', 'md', 'text-gray-500 mr-2') }}
            Recent Opportunities
        </h3>
        <a href="/opportunities/" class="text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors">
            View All →
        </a>
    </div>

    <div class="space-y-3">
        {% for opp in recent_opportunities %}
        {{ entity_card_item(opp, 'opportunity') }}
        {% endfor %}
    </div>
</div>
{% endmacro %}