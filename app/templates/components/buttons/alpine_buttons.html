{% from 'macros/ui.html' import icon %}
{#
  Alpine.js Button Component

  Replaces server-side button generation with client-side Alpine.js rendering.
  Can render dashboard buttons, entity-specific buttons, or custom button arrays.
#}

{# Dashboard Buttons - most common use case #}
{% macro dashboard_buttons() %}
<div x-data="buttonManager()" class="flex flex-wrap gap-3">
    <template x-for="button in dashboardButtons" :key="button.id">
        <button @click="handleButtonClick(button.entityType)"
                :class="getButtonClasses(button)"
                :title="button.description">
            <i :class="getIconClasses(button.icon)"></i>
            <span x-text="button.label"></span>
        </button>
    </template>
</div>
{% endmacro %}

{# Entity-specific buttons (e.g., for index pages) #}
{% macro entity_buttons(entity_types) %}
<div x-data="buttonManager({ entityTypes: {{ entity_types | tojson }} })" class="flex flex-wrap gap-3">
    <template x-for="button in buttons" :key="button.id">
        <button @click="handleButtonClick(button.entityType)"
                :class="getButtonClasses(button)"
                :title="button.description">
            <i :class="getIconClasses(button.icon)"></i>
            <span x-text="button.label"></span>
        </button>
    </template>
</div>
{% endmacro %}

{# Single entity button #}
{% macro single_button(entity_type, label=none, icon=none, size='md') %}
<div x-data="buttonManager()">
    <button @click="handleButtonClick('{{ entity_type }}')"
            class="inline-flex items-center
                   {% if size == 'sm' %}px-3 py-1.5 text-xs{% elif size == 'lg' %}px-6 py-3 text-base{% else %}px-4 py-2 text-sm{% endif %}
                   font-medium text-white bg-blue-600 hover:bg-blue-700 border border-transparent rounded-md
                   focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200 shadow-sm">
        {% if icon %}
        <i class="w-4 h-4 mr-2 {{ icon }}"></i>
        {% else %}
        <i class="w-4 h-4 mr-2" :class="`icon-${entityType}`"></i>
        {% endif %}
        <span>{{ label or ('New ' ~ entity_type.title()) }}</span>
    </button>
</div>
{% endmacro %}

{# Entity action buttons (edit, view, etc.) #}
{% macro entity_actions(entity_type, entity_id, show_view=true, show_edit=true) %}
<div x-data="buttonManager()" class="flex items-center space-x-2">
    {% if show_view %}
    <button @click="viewEntity('{{ entity_type }}', {{ entity_id }})"
            class="text-gray-600 hover:text-gray-800 transition-colors"
            title="View {{ entity_type }}">
        {{ icon('eye', 'sm') }}
    </button>
    {% endif %}

    {% if show_edit %}
    <button @click="editEntity('{{ entity_type }}', {{ entity_id }})"
            class="text-blue-600 hover:text-blue-800 transition-colors"
            title="Edit {{ entity_type }}">
        {{ icon('pencil', 'sm') }}
    </button>
    {% endif %}
</div>
{% endmacro %}

{# Bulk action buttons #}
{% macro bulk_actions(entity_type) %}
<div x-data="buttonManager()" class="flex items-center space-x-3">
    <template x-for="action in getBulkActions('{{ entity_type }}')" :key="action.action">
        <button @click="handleBulkAction(action.action, '{{ entity_type }}')"
                :class="action.class"
                class="inline-flex items-center px-3 py-1.5 text-sm font-medium border border-transparent rounded-md hover:bg-gray-100 transition-colors"
                :title="action.label">
            <i :class="getIconClasses(action.icon)"></i>
            <span x-text="action.label"></span>
        </button>
    </template>
</div>
{% endmacro %}

<script type="module" src="{{ url_for('static', filename='js/alpine/buttonManager.js') }}"></script>