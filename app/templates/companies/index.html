{% extends "base/entity_index.html" %}

{% block entity_config %}
{% set entity_stats = {
    'title': 'Company Overview',
    'stats': [
        {
            'value': companies|length,
            'label': 'Total Companies',
            'color_class': 'text-blue-600'
        },
        {
            'value': companies|selectattr('industry')|list|length,
            'label': 'With Industry',
            'color_class': 'text-green-600'
        },
        {
            'value': companies|map(attribute='contacts')|map('length')|sum if companies|selectattr('contacts')|list else 0,
            'label': 'Total Stakeholders',
            'color_class': 'text-purple-600'
        },
        {
            'value': companies|map(attribute='opportunities')|map('length')|sum if companies|selectattr('opportunities')|list else 0,
            'label': 'Total Opportunities',
            'color_class': 'text-yellow-600'
        }
    ]
} %}
{% set entity_buttons = [
    {
        'label': 'New Company',
        'hx_get': '/modals/Company/create',
        'hx_target': 'body',
        'hx_swap': 'beforeend',
        'icon': plus_icon('w-4 h-4')
    }
] %}
{% endblock %}

{% block entity_filter_controls %}
{% from "macros/ui_elements.html" import htmx_enhanced_filter_controls %}
{{ htmx_enhanced_filter_controls(
    group_options=dropdown_configs.group_by.options if dropdown_configs.group_by else [],
    sort_options=dropdown_configs.sort_by.options if dropdown_configs.sort_by else [],
    sort_direction_options=dropdown_configs.sort_direction.options if dropdown_configs.sort_direction else [],
    primary_filter_options=dropdown_configs.primary_filter.options if dropdown_configs.primary_filter else [],
    primary_filter_label=dropdown_configs.primary_filter.button_text if dropdown_configs.primary_filter else 'All Filters',
    primary_filter_values=dropdown_configs.primary_filter.current_values if dropdown_configs.primary_filter else [],
    expand_collapse_controls=true
) }}
{% endblock %}

{% block entity_imports %}
{% from "macros/base/icons.html" import plus_icon %}
{% endblock %}

