{# Task Rendering Components - Specialized task display logic #}

{% from "macros/entity_card.html" import entity_card %}

{#
  Task Entity Renderer - Handles complex parent/child task relationships
  
  This extracts the complex task rendering logic from entity_content.html
  to make it reusable and maintainable.
  
  Parameters:
  - entity (required): Task entity object
  - render_children (optional): Whether to render child tasks (default: true)
  - child_container_classes (optional): CSS classes for child container
  
  Usage:
  {{ render_task_entity(task) }}
  {{ render_task_entity(task, render_children=false) }}
#}
{% macro render_task_entity(entity, render_children=true, child_container_classes='ml-8 mt-4 space-y-2 border-l-2 border-gray-200 pl-4') %}
  {# Only render if this is not a child task (children are rendered by their parents) #}
  {% if entity.task_type != 'child' %}
    <div class="p-4">
      {{ entity_card(entity, 'task') }}

      {# Render child tasks if this is a parent and children should be rendered #}
      {% if render_children and entity.task_type == 'parent' and entity.child_tasks %}
        <div class="child-task-container ml-8 mt-4 space-y-2 border-l-2 border-gray-200 pl-4">
          {% for child_task in entity.child_tasks %}
            <div class="child-task-item">
              {{ entity_card(child_task, 'task') }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>
  {% endif %}
{% endmacro %}

{#
  Simple Task Renderer - For when parent/child logic is not needed
  
  Parameters:
  - entity (required): Task entity object
  - container_classes (optional): CSS classes for container
  
  Usage:
  {{ render_simple_task(task) }}
#}
{% macro render_simple_task(entity, container_classes='p-4') %}
  <div class="{{ container_classes }}">
    {{ entity_card(entity, 'task') }}
  </div>
{% endmacro %}

{#
  Child Task List - Renders a list of child tasks
  
  Parameters:
  - child_tasks (required): List of child task objects
  - container_classes (optional): CSS classes for container
  - item_classes (optional): CSS classes for each child item
  
  Usage:
  {{ render_child_task_list(parent_task.child_tasks) }}
#}
{% macro render_child_task_list(child_tasks, container_classes='child-task-container', item_classes='child-task-item') %}
  {% if child_tasks %}
    <div class="{{ container_classes }}">
      {% for child_task in child_tasks %}
        <div class="{{ item_classes }}">
          {{ entity_card(child_task, 'task') }}
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endmacro %}