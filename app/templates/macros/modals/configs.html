{# Entity Modal Configurations - Detail Modal Configs Only #}

{# Task Detail Modal Configuration #}
{% set task_detail_config = {
    "title": "Task Details",
    "default_values": {
        "description": "",
        "due_date": "",
        "priority": "medium",
        "next_step_type": "",
        "status": "pending"
    },
    "tabs": [
        {
            "key": "details",
            "label": "Details"
        },
        {
            "key": "subtasks",
            "label": "Sub-tasks",
            "condition": "task.task_type === 'parent'",
            "badge": "task.child_tasks ? task.child_tasks.length : 0",
            "content": '''
                <template x-for="childTask in task.child_tasks" :key="childTask.id">
                    <div class="p-3 border border-gray-200 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3 flex-grow">
                                <input type="checkbox" 
                                       :checked="childTask.status === \"complete\""
                                       @change="toggleChildTask(childTask.id)"
                                       class="text-blue-600 focus:ring-blue-500 border-gray-300">
                                <div class="flex-grow">
                                    <p class="text-sm font-medium text-gray-900" x-text="childTask.description"></p>
                                    <div class="flex items-center space-x-4 text-xs-gray-500 mt-1">
                                        <span x-show="childTask.due_date" x-text="new Date(childTask.due_date).toLocaleDateString()"></span>
                                        <span class="capitalize" x-text="childTask.priority"></span>
                                        <span x-show="childTask.next_step_type" class="uppercase" x-text="childTask.next_step_type"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span :class="childTask.status === \"complete\" ? \"bg-green-100 text-green-800\" : \"bg-gray-100 text-gray-800\""
                                      class="px-2 py-1 text-xs font-medium rounded-full capitalize" 
                                      x-text="childTask.status.replace(\"_\", \" \")"></span>
                            </div>
                        </div>
                    </div>
                </template>
                
                <div x-show="!task.child_tasks || task.child_tasks.length === 0" 
                     class="text-gray-500 text-sm italic text-center py-4">
                    No sub-tasks
                </div>
            '''
        },
        {
            "key": "notes",
            "label": "Notes",
            "badge": "notes.length"
        }
    ],
    "fields": [
        {
            "type": "textarea",
            "name": "description",
            "label": "Description",
            "rows": 3
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "select",
                    "name": "priority",
                    "label": "Priority",
                    "options": [
                        {"value": "low", "label": "Low"},
                        {"value": "medium", "label": "Medium"},
                        {"value": "high", "label": "High"}
                    ]
                },
                {
                    "type": "select",
                    "name": "status",
                    "label": "Status",
                    "options": [
                        {"value": "pending", "label": "Pending"},
                        {"value": "in_progress", "label": "In Progress"},
                        {"value": "complete", "label": "Complete"}
                    ]
                }
            ]
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "date",
                    "name": "due_date",
                    "label": "Due Date"
                },
                {
                    "type": "text",
                    "name": "next_step_type",
                    "label": "Next Step Type",
                    "placeholder": "e.g., call, email, meeting"
                }
            ]
        }
    ]
} %}

{# Stakeholder Detail Modal Configuration #}
{% set stakeholder_detail_config = {
    "title": "Stakeholder Details",
    "show_notes": true,
    "default_values": {
        "name": "",
        "email": "",
        "phone": "",
        "job_title": "",
        "company_id": ""
    },
    "fields": [
        {
            "type": "text",
            "name": "name",
            "label": "Full Name",
            "placeholder": "Stakeholder name"
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "text",
                    "name": "email",
                    "label": "Email",
                    "placeholder": "Stakeholder email"
                },
                {
                    "type": "text",
                    "name": "phone",
                    "label": "Phone",
                    "placeholder": "Stakeholder phone number"
                }
            ]
        },
        {
            "type": "text",
            "name": "job_title",
            "label": "Job Title",
            "placeholder": "Job title or role"
        }
    ]
} %}

{# Company Detail Modal Configuration #}
{% set company_detail_config = {
    "title": "Company Details",
    "title_singular": "Company",
    "show_notes": true,
    "default_values": {
        "name": "",
        "industry": "",
        "size": "",
        "website": "",
        "phone": "",
        "address": ""
    },
    "fields": [
        {
            "type": "text",
            "name": "name",
            "label": "Company Name",
            "placeholder": "Company name"
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "select",
                    "name": "industry",
                    "label": "Industry",
                    "options": [
                        {"value": "", "label": "Select industry"},
                        {"value": "technology", "label": "Technology"},
                        {"value": "finance", "label": "Finance"},
                        {"value": "healthcare", "label": "Healthcare"},
                        {"value": "manufacturing", "label": "Manufacturing"},
                        {"value": "retail", "label": "Retail"},
                        {"value": "education", "label": "Education"},
                        {"value": "consulting", "label": "Consulting"},
                        {"value": "other", "label": "Other"}
                    ]
                },
                {
                    "type": "select",
                    "name": "size",
                    "label": "Company Size",
                    "options": [
                        {"value": "", "label": "Select size"},
                        {"value": "startup", "label": "Startup (1-10)"},
                        {"value": "small", "label": "Small (11-50)"},
                        {"value": "medium", "label": "Medium (51-200)"},
                        {"value": "large", "label": "Large (201-1000)"},
                        {"value": "enterprise", "label": "Enterprise (1000+)"}
                    ]
                }
            ]
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "text",
                    "name": "website",
                    "label": "Website",
                    "placeholder": "https://company.com"
                },
                {
                    "type": "text",
                    "name": "phone",
                    "label": "Phone",
                    "placeholder": "Company phone number"
                }
            ]
        },
        {
            "type": "textarea",
            "name": "address",
            "label": "Address",
            "rows": 2,
            "placeholder": "Company address"
        }
    ]
} %}

{# Opportunity Detail Modal Configuration #}
{% set opportunity_detail_config = {
    "title": "Opportunity Details",
    "show_notes": true,
    "default_values": {
        "name": "",
        "value": "",
        "stage": "",
        "probability": "",
        "expected_close_date": "",
        "company_id": ""
    },
    "fields": [
        {
            "type": "text",
            "name": "name",
            "label": "Opportunity Name",
            "placeholder": "Opportunity name"
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "text",
                    "name": "value",
                    "label": "Value ($)",
                    "placeholder": "Opportunity value"
                },
                {
                    "type": "select",
                    "name": "stage",
                    "label": "Stage",
                    "options": [
                        {"value": "", "label": "Select stage"},
                        {"value": "lead", "label": "Lead"},
                        {"value": "qualified", "label": "Qualified"},
                        {"value": "proposal", "label": "Proposal"},
                        {"value": "negotiation", "label": "Negotiation"},
                        {"value": "closed_won", "label": "Closed Won"},
                        {"value": "closed_lost", "label": "Closed Lost"}
                    ]
                }
            ]
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "text",
                    "name": "probability",
                    "label": "Probability (%)",
                    "placeholder": "0-100"
                },
                {
                    "type": "date",
                    "name": "expected_close_date",
                    "label": "Expected Close Date"
                }
            ]
        }
    ]
} %}

{# === NEW MODAL CONFIGURATIONS === #}

{# Company New Modal Configuration #}
{% set company_new_config = {
    "title": "Create New Company",
    "save_text": "Save",
    "api_endpoint": "/companies/create",
    "error_message": "Error creating company",
    "default_values": {
        "name": "",
        "industry": "",
        "size": "",
        "website": "",
        "phone": "",
        "address": ""
    },
    "validations": [
        {
            "condition": "!this.company.name.trim()",
            "message": "Company name is required"
        }
    ],
    "fields": [
        {
            "type": "text",
            "name": "name",
            "label": "Company Name",
            "placeholder": "Company name",
            "required": true
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "select",
                    "name": "industry",
                    "label": "Industry",
                    "options": [
                        {"value": "", "label": "Select industry"},
                        {"value": "technology", "label": "Technology"},
                        {"value": "finance", "label": "Finance"},
                        {"value": "healthcare", "label": "Healthcare"},
                        {"value": "manufacturing", "label": "Manufacturing"},
                        {"value": "retail", "label": "Retail"},
                        {"value": "education", "label": "Education"},
                        {"value": "consulting", "label": "Consulting"},
                        {"value": "other", "label": "Other"}
                    ]
                },
                {
                    "type": "select",
                    "name": "size",
                    "label": "Company Size",
                    "options": [
                        {"value": "", "label": "Select size"},
                        {"value": "startup", "label": "Startup (1-10)"},
                        {"value": "small", "label": "Small (11-50)"},
                        {"value": "medium", "label": "Medium (51-200)"},
                        {"value": "large", "label": "Large (201-1000)"},
                        {"value": "enterprise", "label": "Enterprise (1000+)"}
                    ]
                }
            ]
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "text",
                    "name": "website",
                    "label": "Website",
                    "placeholder": "https://company.com",
                    "input_type": "url"
                },
                {
                    "type": "text",
                    "name": "phone",
                    "label": "Phone",
                    "placeholder": "Company phone number",
                    "input_type": "tel"
                }
            ]
        },
        {
            "type": "textarea",
            "name": "address",
            "label": "Address",
            "rows": 2,
            "placeholder": "Company address"
        }
    ]
} %}

{# Stakeholder New Modal Configuration #}
{% set stakeholder_new_config = {
    "title": "Create New Stakeholder",
    "save_text": "Save",
    "api_endpoint": "/api/stakeholders",
    "error_message": "Error creating stakeholder",
    "default_values": {
        "name": "",
        "email": "",
        "phone": "",
        "job_title": ""
    },
    "validations": [
        {
            "condition": "!this.stakeholder.name.trim()",
            "message": "Name is required"
        }
    ],
    "fields": [
        {
            "type": "text",
            "name": "name",
            "label": "Full Name",
            "placeholder": "Stakeholder name",
            "required": true
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "text",
                    "name": "email",
                    "label": "Email",
                    "placeholder": "contact@company.com",
                    "input_type": "email"
                },
                {
                    "type": "text",
                    "name": "phone",
                    "label": "Phone",
                    "placeholder": "Phone number",
                    "input_type": "tel"
                }
            ]
        },
        {
            "type": "text",
            "name": "job_title",
            "label": "Job Title",
            "placeholder": "Job title or role"
        }
    ]
} %}

{# Opportunity New Modal Configuration #}
{% set opportunity_new_config = {
    "title": "Create New Opportunity",
    "save_text": "Save",
    "api_endpoint": "/opportunities/create",
    "error_message": "Error creating opportunity",
    "default_values": {
        "name": "",
        "value": "",
        "stage": "prospect",
        "probability": 25,
        "expected_close_date": "",
        "company_id": None,
        "company_name": ""
    },
    "additional_fields": {
        "selectedAccountTeam": [],
        "selectedStakeholders": []
    },
    "validations": [
        {
            "condition": "!this.opportunity.name.trim()",
            "message": "Opportunity name is required"
        },
        {
            "condition": "!this.opportunity.value.trim()",
            "message": "Value is required"
        },
        {
            "condition": "!this.opportunity.company_id",
            "message": "Company is required"
        }
    ],
    "payload_transform": "{ ...this.opportunity, account_team_members: this.selectedAccountTeam.map(m => m.id), stakeholders: this.selectedStakeholders.map(s => s.id) }",
    "fields": [
        {
            "type": "text",
            "name": "name",
            "label": "Opportunity Name",
            "placeholder": "Opportunity name",
            "required": true
        },
        {
            "type": "custom",
            "template": '''
                <div class="form-group">
                    <label class="form-label required">Company</label>
                    <input x-model="opportunity.company_name"
                           type="text" 
                           class="form-input"
                           placeholder="Select company"
                           data-autocomplete="company"
                           required
                           @change="opportunity.company_id = $event.target.dataset.selectedId || null">
                </div>
            '''
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "number",
                    "name": "value",
                    "label": "Value ($)",
                    "placeholder": "10000",
                    "required": true
                },
                {
                    "type": "select",
                    "name": "stage",
                    "label": "Stage",
                    "options": [
                        {"value": "prospect", "label": "Prospect"},
                        {"value": "qualified", "label": "Qualified"},
                        {"value": "proposal", "label": "Proposal"},
                        {"value": "negotiation", "label": "Negotiation"},
                        {"value": "closed_won", "label": "Closed Won"},
                        {"value": "closed_lost", "label": "Closed Lost"}
                    ]
                }
            ]
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "number",
                    "name": "probability",
                    "label": "Probability (%)",
                    "placeholder": "25",
                    "min": 0,
                    "max": 100
                },
                {
                    "type": "date",
                    "name": "expected_close_date",
                    "label": "Expected Close Date"
                }
            ]
        },
        {
            "type": "custom",
            "template": '''
                <!-- Account Team Members (Optional) -->
                <div class="form-group">
                    <label class="form-label">Account Team Members (Optional)</label>
                    <input type="text" 
                           class="form-input"
                           placeholder="Search team members..."
                           data-autocomplete="user">
                    <div x-show="selectedAccountTeam.length > 0" class="mt-2">
                        <template x-for="member in selectedAccountTeam" :key="member.id">
                            <span class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800 mr-2 mb-1">
                                <span x-text="member.name + (member.job_title ? \' (\' + member.job_title + \')\' : \'\')"></span>
                                <button @click="selectedAccountTeam = selectedAccountTeam.filter(m => m.id !== member.id)" 
                                        class="ml-1 text-blue-600 hover:text-blue-800">×</button>
                            </span>
                        </template>
                    </div>
                </div>

                <!-- Stakeholders (Optional) -->
                <div class="form-group">
                    <label class="form-label">Stakeholders (Optional)</label>
                    <input type="text" 
                           class="form-input"
                           placeholder="Search stakeholders..."
                           data-autocomplete="stakeholder">
                    <div x-show="selectedStakeholders.length > 0" class="mt-2">
                        <template x-for="stakeholder in selectedStakeholders" :key="stakeholder.id">
                            <span class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800 mr-2 mb-1">
                                <span x-text="stakeholder.name + (stakeholder.job_title ? \' (\' + stakeholder.job_title + \')\' : \'\')"></span>
                                <button @click="selectedStakeholders = selectedStakeholders.filter(s => s.id !== stakeholder.id)" 
                                        class="ml-1 text-green-600 hover:text-green-800">×</button>
                            </span>
                        </template>
                    </div>
                </div>
            '''
        }
    ]
} %}

{# Task New Modal Configuration #}
{% set task_new_config = {
    "title": "Create New Task",
    "save_text": "Save",
    "api_endpoint": "/tasks/create",
    "error_message": "Error creating task",
    "default_values": {
        "description": "",
        "due_date": "",
        "priority": "medium",
        "next_step_type": ""
    },
    "validations": [
        {
            "condition": "!this.task.description.trim()",
            "message": "Task description is required"
        }
    ],
    "fields": [
        {
            "type": "textarea",
            "name": "description",
            "label": "Description",
            "placeholder": "Task description",
            "rows": 3,
            "required": true
        },
        {
            "type": "grid",
            "columns": 2,
            "fields": [
                {
                    "type": "select",
                    "name": "priority",
                    "label": "Priority",
                    "options": [
                        {"value": "low", "label": "Low"},
                        {"value": "medium", "label": "Medium"},
                        {"value": "high", "label": "High"}
                    ]
                },
                {
                    "type": "date",
                    "name": "due_date",
                    "label": "Due Date"
                }
            ]
        },
        {
            "type": "text",
            "name": "next_step_type",
            "label": "Next Step Type",
            "placeholder": "e.g., call, email, meeting"
        }
    ]
} %}