{% from "macros/ui/list_section.html" import list_section, simple_list_item, alert_list_item, note_list_item %}
{% from "macros/ui/metadata_display.html" import task_metadata %}
{% from "macros/base/icons.html" import icon %}

{% macro dashboard_overdue_section(overdue_tasks) %}
{# Professional Overdue Tasks Section #}
{% if overdue_tasks %}
<div class="p-6 bg-white rounded-lg border border-gray-200 shadow-sm">
    <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-900 flex items-center">
            {{ icon('exclamation-triangle', 'md', 'text-red-500 mr-2') }}
            Overdue Tasks
        </h3>
        <a href="/tasks/" class="text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors">
            View All →
        </a>
    </div>

    <div class="space-y-3">
        {% for task in overdue_tasks %}
        <div class="p-3 bg-red-50 rounded-lg border border-red-200 hover:bg-red-100 transition-colors">
            <div class="font-medium text-gray-900 mb-1">{{ task.description }}</div>
            <div class="text-sm text-red-600">{{ task_metadata(task) }}</div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}
{% endmacro %}

{% macro dashboard_notes_section(recent_notes) %}
{# Professional Recent Notes Section #}
<div class="p-6 bg-white rounded-lg border border-gray-200 shadow-sm">
    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
        {{ icon('document-text', 'md', 'text-gray-500 mr-2') }}
        Recent Notes
    </h3>

    <div class="space-y-3">
        {% for note in recent_notes %}
        <div class="p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
            <p class="text-gray-900 mb-2 line-clamp-3">{{ note.content }}</p>
            <p class="text-sm text-gray-600">
                {{ note.created_at_formatted }}{{ (' • ' + note.entity_name) if note.entity_name else '' }}
            </p>
        </div>
        {% endfor %}
    </div>
</div>
{% endmacro %}

{% macro dashboard_tasks_section(recent_tasks) %}
{# Professional Recent Tasks Section #}
<div class="p-6 bg-white rounded-lg border border-gray-200 shadow-sm">
    <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-900 flex items-center">
            {{ icon('clipboard-list', 'md', 'text-gray-500 mr-2') }}
            Recent Tasks
        </h3>
        <a href="/tasks/" class="text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors">
            View All →
        </a>
    </div>

    <div class="space-y-3">
        {% for task in recent_tasks %}
        <div class="p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <div class="font-medium text-gray-900 mb-1">{{ task.description }}</div>
                    <div class="text-sm text-gray-600">{{ task_metadata(task) }}</div>
                </div>
                {% from "macros/ui/badges.html" import priority_badge %}
                <span class="ml-3">
                    {{ priority_badge(task.priority) }}
                </span>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endmacro %}

{% macro dashboard_opportunities_section(recent_opportunities) %}
{# Professional Recent Opportunities Section #}
<div class="p-6 bg-white rounded-lg border border-gray-200 shadow-sm">
    <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-900 flex items-center">
            {{ icon('currency-dollar', 'md', 'text-gray-500 mr-2') }}
            Recent Opportunities
        </h3>
        <a href="/opportunities/" class="text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors">
            View All →
        </a>
    </div>

    <div class="space-y-3">
        {% for opp in recent_opportunities %}
        <div class="p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <div class="font-medium text-gray-900 mb-1">{{ opp.name }}</div>
                    <div class="text-sm text-gray-600">
                        <span class="text-blue-600">{{ opp.company_name }}</span> •
                        <span class="font-medium text-green-600">{{ opp.value_formatted }}</span>
                    </div>
                </div>
                <span class="ml-3 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700">
                    {{ opp.stage|title }}
                </span>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endmacro %}